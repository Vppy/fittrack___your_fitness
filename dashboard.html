<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FitTrack - Dashboard</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="dashboard-container">
        <header class="dashboard-header">
            <div class="logo">
                <svg width="50" height="50" viewBox="0 0 100 100">
                    <circle cx="50" cy="50" r="45" fill="none" stroke="#4CAF50" stroke-width="5"/>
                    <path d="M30 50 L45 65 L70 35" fill="none" stroke="#4CAF50" stroke-width="5"/>
                </svg>
            </div>
            <h1>Welcome, <span id="userNameDisplay">User</span>!</h1>
            <button class="btn secondary" onclick="handleLogout()">Logout</button>
        </header>
        
        <div class="dashboard-grid">
            <!-- Profile Card with Picture -->
            <div class="dashboard-card profile-card">
                <div class="profile-header">
                    <div class="profile-picture">
                        <svg width="100" height="100" viewBox="0 0 100 100">
                            <circle cx="50" cy="40" r="25" fill="#4CAF50"/>
                            <circle cx="50" cy="95" r="45" fill="#4CAF50"/>
                        </svg>
                    </div>
                    <div id="profileInfo"></div>
                </div>
                <div class="stats-grid">
                    <div class="stat-item">
                        <label>Weight</label>
                        <span id="weightDisplay">-- kg</span>
                    </div>
                    <div class="stat-item">
                        <label>Height</label>
                        <span id="heightDisplay">-- cm</span>
                    </div>
                    <div class="stat-item">
                        <label>BMI</label>
                        <span id="bmiDisplay">--</span>
                    </div>
                </div>
            </div>

            <!-- Activities Card -->
            <div class="dashboard-card activities-card">
                <h3>Your Activities</h3>
                <div class="activities-grid">
                    <button class="activity-btn" onclick="showActivityModal('running')">
                        <svg width="24" height="24" viewBox="0 0 24 24">
                            <path d="M13.5 5.5c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zM9.8 8.9L7 23h2.1l1.8-8 2.1 2v6h2v-7.5l-2.1-2 .6-3C14.8 12 16.8 13 19 13v-2c-1.9 0-3.5-1-4.3-2.4l-1-1.6c-.4-.6-1-1-1.7-1-.3 0-.5.1-.8.1L6 8.3V13h2V9.6l1.8-.7" fill="#4CAF50"/>
                        </svg>
                        Running
                    </button>
                    <button class="activity-btn" onclick="showActivityModal('swimming')">
                        <svg width="24" height="24" viewBox="0 0 24 24">
                            <path d="M22 21c-1.11 0-1.73-.37-2.18-.64-.37-.22-.6-.36-1.15-.36-.56 0-.78.13-1.15.36-.46.27-1.07.64-2.18.64s-1.73-.37-2.18-.64c-.37-.22-.6-.36-1.15-.36-.56 0-.78.13-1.15.36-.45.27-1.07.64-2.18.64s-1.73-.37-2.18-.64c-.37-.22-.6-.36-1.15-.36s-.78.13-1.15.36c-.47.27-1.08.64-2.19.64v-2c.56 0 .78-.13 1.15-.36.47-.27 1.08-.64 2.19-.64s1.73.37 2.18.64c.37.22.6.36 1.15.36.56 0 .78-.13 1.15-.36.45-.27 1.07-.64 2.18-.64s1.73.37 2.18.64c.37.22.6.36 1.15.36s.78-.13 1.15-.36c.45-.27 1.07-.64 2.18-.64s1.73.37 2.18.64c.37.22.6.36 1.15.36v2zm0-4.5c-1.11 0-1.73-.37-2.18-.64-.37-.22-.6-.36-1.15-.36-.56 0-.78.13-1.15.36-.45.27-1.07.64-2.18.64s-1.73-.37-2.18-.64c-.37-.22-.6-.36-1.15-.36-.56 0-.78.13-1.15.36-.45.27-1.07.64-2.18.64s-1.73-.37-2.18-.64c-.37-.22-.6-.36-1.15-.36s-.78.13-1.15.36c-.47.27-1.08.64-2.19.64v-2c.56 0 .78-.13 1.15-.36.47-.27 1.08-.64 2.19-.64s1.73.37 2.18.64c.37.22.6.36 1.15.36.56 0 .78-.13 1.15-.36.45-.27 1.07-.64 2.18-.64s1.73.37 2.18.64c.37.22.6.36 1.15.36s.78-.13 1.15-.36c.45-.27 1.07-.64 2.18-.64s1.73.37 2.18.64c.37.22.6.36 1.15.36v2zm-1.15-7.36c-.37-.22-.6-.36-1.15-.36-.56 0-.78.13-1.15.36-.45.27-1.07.64-2.18.64s-1.73-.37-2.18-.64c-.37-.22-.6-.36-1.15-.36-.56 0-.78.13-1.15.36-.45.27-1.07.64-2.18.64s-1.73-.37-2.18-.64c-.37-.22-.6-.36-1.15-.36s-.78.13-1.15.36c-.47.27-1.08.64-2.19.64v-2c.56 0 .78-.13 1.15-.36.47-.27 1.08-.64 2.19-.64s1.73.37 2.18.64c.37.22.6.36 1.15.36.56 0 .78-.13 1.15-.36.45-.27 1.07-.64 2.18-.64s1.73.37 2.18.64c.37.22.6.36 1.15.36s.78-.13 1.15-.36c.45-.27 1.07-.64 2.18-.64s1.73.37 2.18.64c.37.22.6.36 1.15.36v2c-1.11 0-1.73-.37-2.18-.64z" fill="#4CAF50"/>
                        </svg>
                        Swimming
                    </button>
                    <button class="activity-btn" onclick="showActivityModal('cardio')">
                        <svg width="24" height="24" viewBox="0 0 24 24">
                            <path d="M7.5 4.5c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zM9.8 8.9L7 23h2.1l1.8-8 2.1 2v6h2v-7.5l-2.1-2 .6-3C14.8 12 16.8 13 19 13v-2c-1.9 0-3.5-1-4.3-2.4l-1-1.6c-.4-.6-1-1-1.7-1-.3 0-.5.1-.8.1L6 8.3V13h2V9.6l1.8-.7" fill="#4CAF50"/>
                        </svg>
                        Cardio
                    </button>
                    <button class="activity-btn" onclick="showActivityModal('strength')">
                        <svg width="24" height="24" viewBox="0 0 24 24">
                            <path d="M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z" fill="#4CAF50"/>
                        </svg>
                        Strength
                    </button>
                    <button class="activity-btn" onclick="showActivityModal('cycling')">
                        <svg width="24" height="24" viewBox="0 0 24 24">
                            <path d="M15.5 5.5c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zM5 12c-2.8 0-5 2.2-5 5s2.2 5 5 5 5-2.2 5-5-2.2-5-5-5zm0 8.5c-1.9 0-3.5-1.6-3.5-3.5s1.6-3.5 3.5-3.5 3.5 1.6 3.5 3.5-1.6 3.5-3.5 3.5zm5.8-10l2.4-2.4.8.8c1.3 1.3 3 2.1 5.1 2.1V9c-1.5 0-2.7-.6-3.6-1.5l-1.9-1.9c-.5-.4-1-.6-1.6-.6s-1.1.2-1.4.6L7.8 8.4c-.4.4-.6.9-.6 1.4 0 .6.2 1.1.6 1.4L11 14v5h2v-6.2l-2.2-2.3zM19 12c-2.8 0-5 2.2-5 5s2.2 5 5 5 5-2.2 5-5-2.2-5-5-5zm0 8.5c-1.9 0-3.5-1.6-3.5-3.5s1.6-3.5 3.5-3.5 3.5 1.6 3.5 3.5-1.6 3.5-3.5 3.5z" fill="#4CAF50"/>
                        </svg>
                        Cycling
                    </button>
                    <button class="activity-btn" onclick="showActivityModal('yoga')">
                        <svg width="24" height="24" viewBox="0 0 24 24">
                            <path d="M13 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm4 7h-3V7h-2v2H9c-1.1 0-2 .9-2 2v9h2v-5h6v5h2v-9c0-1.1-.9-2-2-2z" fill="#4CAF50"/>
                        </svg>
                        Yoga
                    </button>
                </div>
            </div>

            <!-- Progress Card -->
            <div class="dashboard-card progress-card">
                <h3>Progress</h3>
                <div class="progress-stats">
                    <div class="progress-item">
                        <label>Total Calories Burned</label>
                        <div class="progress-bar">
                            <div id="caloriesProgress" class="progress-fill" style="width: 0%">
                                <span id="caloriesValue">0</span>
                            </div>
                        </div>
                    </div>
                    <div class="progress-item">
                        <label>Weekly Goal Progress</label>
                        <div class="progress-bar">
                            <div id="weeklyProgress" class="progress-fill" style="width: 0%">
                                <span id="weeklyValue">0%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Activity Modal -->
    <div id="activityModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal()">&times;</span>
            <h2 id="modalTitle">Add Activity</h2>
            <form id="activityForm" onsubmit="handleActivitySubmit(event)">
                <!-- Dynamic form fields will be inserted here -->
                <div id="dynamicFields"></div>
                <button type="submit" class="btn primary">Save Activity</button>
            </form>
        </div>
    </div>

    <script>
        let currentActivity = '';
        let totalCalories = 0;

        // Activity specific form fields
        const activityFields = {
            running: `
                <div class="form-group">
                    <label for="steps">Steps Walked</label>
                    <input type="number" id="steps" required min="1">
                </div>
                <div class="form-group">
                    <label for="distance">Distance (km)</label>
                    <input type="number" id="distance" required min="0" step="0.1">
                </div>
                <div class="form-group">
                    <label for="duration">Time Taken (minutes)</label>
                    <input type="number" id="duration" required min="1">
                </div>
                <div class="form-group">
                    <label for="intensity">Intensity</label>
                    <select id="intensity" required>
                        <option value="low">Low</option>
                        <option value="medium">Medium</option>
                        <option value="high">High</option>
                    </select>
                </div>
            `,
            swimming: `
                <div class="form-group">
                    <label for="duration">Duration (minutes)</label>
                    <input type="number" id="duration" required min="1">
                </div>
                <div class="form-group">
                    <label for="intensity">Intensity</label>
                    <select id="intensity" required>
                        <option value="low">Low</option>
                        <option value="medium">Medium</option>
                        <option value="high">High</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="type">Swimming Type</label>
                    <select id="type" required>
                        <option value="freestyle">Freestyle</option>
                        <option value="breaststroke">Breaststroke</option>
                        <option value="butterfly">Butterfly</option>
                        <option value="backstroke">Backstroke</option>
                    </select>
                </div>
            `,
            cardio: `
                <div class="form-group">
                    <label for="duration">Duration (minutes)</label>
                    <input type="number" id="duration" required min="1">
                </div>
                <div class="form-group">
                    <label for="intensity">Intensity</label>
                    <select id="intensity" required>
                        <option value="low">Low</option>
                        <option value="medium">Medium</option>
                        <option value="high">High</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="type">Cardio Type</label>
                    <select id="type" required>
                        <option value="jumping_jacks">Jumping Jacks</option>
                        <option value="burpees">Burpees</option>
                        <option value="mountain_climbers">Mountain Climbers</option>
                        <option value="jump_rope">Jump Rope</option>
                    </select>
                </div>
            `,
            strength: `
                <div class="form-group">
                    <label for="duration">Duration (minutes)</label>
                    <input type="number" id="duration" required min="1">
                </div>
                <div class="form-group">
                    <label for="weight">Weight Lifted (kg)</label>
                    <input type="number" id="weight" required min="0" step="0.5">
                </div>
                <div class="form-group">
                    <label for="intensity">Intensity</label>
                    <select id="intensity" required>
                        <option value="low">Low</option>
                        <option value="medium">Medium</option>
                        <option value="high">High</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="type">Workout Type</label>
                    <select id="type" required>
                        <option value="upper_body">Upper Body</option>
                        <option value="lower_body">Lower Body</option>
                        <option value="core">Core</option>
                        <option value="full_body">Full Body</option>
                    </select>
                </div>
            `,
            cycling: `
                <div class="form-group">
                    <label for="duration">Duration (minutes)</label>
                    <input type="number" id="duration" required min="1">
                </div>
                <div class="form-group">
                    <label for="intensity">Intensity</label>
                    <select id="intensity" required>
                        <option value="low">Low</option>
                        <option value="medium">Medium</option>
                        <option value="high">High</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="type">Cycling Type</label>
                    <select id="type" required>
                        <option value="road">Road Cycling</option>
                        <option value="mountain">Mountain Biking</option>
                        <option value="stationary">Stationary Bike</option>
                        <option value="spinning">Spinning</option>
                    </select>
                </div>
            `,
            yoga: `
                <div class="form-group">
                    <label for="duration">Duration (minutes)</label>
                    <input type="number" id="duration" required min="1">
                </div>
                <div class="form-group">
                    <label for="intensity">Intensity</label>
                    <select id="intensity" required>
                        <option value="low">Beginner</option>
                        <option value="medium">Intermediate</option>
                        <option value="high">Advanced</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="type">Yoga Type</label>
                    <select id="type" required>
                        <option value="hatha">Hatha</option>
                        <option value="vinyasa">Vinyasa</option>
                        <option value="ashtanga">Ashtanga</option>
                        <option value="yin">Yin</option>
                    </select>
                </div>
            `
        };

        // Check if user is logged in
        window.onload = function() {
            const currentUser = JSON.parse(localStorage.getItem('currentUser'));
            if (!currentUser) {
                window.location.href = 'login.html';
                return;
            }

            // Display user information
            document.getElementById('userNameDisplay').textContent = currentUser.firstName;
            document.getElementById('weightDisplay').textContent = currentUser.weight + ' kg';
            document.getElementById('heightDisplay').textContent = currentUser.height + ' cm';
            
            // Calculate and display BMI
            const heightInMeters = currentUser.height / 100;
            const bmi = (currentUser.weight / (heightInMeters * heightInMeters)).toFixed(1);
            document.getElementById('bmiDisplay').textContent = bmi;

            // Display profile info
            const profileHTML = `
                <p><strong>Name:</strong> ${currentUser.firstName} ${currentUser.lastName}</p>
                <p><strong>Email:</strong> ${currentUser.email}</p>
                <p><strong>Phone:</strong> ${currentUser.phone}</p>
                <p><strong>Gender:</strong> ${currentUser.gender}</p>
            `;
            document.getElementById('profileInfo').innerHTML = profileHTML;

            // Load saved activities
            loadActivities();
        };

        function showActivityModal(activity) {
            currentActivity = activity;
            document.getElementById('modalTitle').textContent = 
                `Add ${activity.charAt(0).toUpperCase() + activity.slice(1)} Activity`;
            document.getElementById('dynamicFields').innerHTML = activityFields[activity];
            document.getElementById('activityModal').style.display = 'block';
        }

        function closeModal() {
            document.getElementById('activityModal').style.display = 'none';
        }

        function handleActivitySubmit(event) {
            event.preventDefault();
            
            // Get common fields
            const duration = Number(document.getElementById('duration').value);
            const intensity = document.getElementById('intensity').value;
            const type = document.getElementById('type')?.value;

            // Get activity specific fields
            let additionalData = {};
            if (currentActivity === 'running') {
                additionalData = {
                    steps: Number(document.getElementById('steps').value),
                    distance: Number(document.getElementById('distance').value)
                };
            } else if (currentActivity === 'strength') {
                additionalData = {
                    weight: Number(document.getElementById('weight').value)
                };
            }

            // Calculate calories based on activity and intensity
            const caloriesPerMinute = {
                running: { low: 8, medium: 10, high: 12 },
                swimming: { low: 6, medium: 8, high: 10 },
                cardio: { low: 5, medium: 7, high: 9 },
                strength: { low: 3, medium: 5, high: 7 },
                cycling: { low: 4, medium: 6, high: 8 },
                yoga: { low: 2, medium: 3, high: 4 }
            };

            const calories = duration * caloriesPerMinute[currentActivity][intensity];
            totalCalories += calories;

            // Save activity
            const activities = JSON.parse(localStorage.getItem('activities') || '[]');
            activities.push({
                type: currentActivity,
                duration,
                intensity,
                activityType: type,
                calories,
                ...additionalData,
                date: new Date().toISOString()
            });
            localStorage.setItem('activities', JSON.stringify(activities));

            // Update progress
            updateProgress();
            closeModal();
        }

        function loadActivities() {
            const activities = JSON.parse(localStorage.getItem('activities') || '[]');
            totalCalories = activities.reduce((sum, activity) => sum + activity.calories, 0);
            updateProgress();
        }

        function updateProgress() {
            // Update calories progress (assuming 2000 calories weekly goal)
            const caloriesPercent = Math.min((totalCalories / 2000) * 100, 100);
            document.getElementById('caloriesProgress').style.width = caloriesPercent + '%';
            document.getElementById('caloriesValue').textContent = totalCalories + ' cal';

            // Update weekly progress (simple calculation for demo)
            const weeklyPercent = Math.min((totalCalories / 3500) * 100, 100);
            document.getElementById('weeklyProgress').style.width = weeklyPercent + '%';
            document.getElementById('weeklyValue').textContent = Math.round(weeklyPercent) + '%';
        }

        function handleLogout() {
            localStorage.removeItem('currentUser');
            window.location.href = 'login.html';
        }
    </script>
</body>
</html>